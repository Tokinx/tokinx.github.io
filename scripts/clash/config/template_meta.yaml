mixed-port: 7890
allow-lan: true
external-controller: 0.0.0.0:9090
mode: Rule
log-level: info
ipv6: true
tcp-concurrent: true
unified-delay: true
dns:
  enable: true
  ipv6: true
  prefer-h3: false
  default-nameserver:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
    - 1.1.1.1
    - 8.8.8.8
  nameserver:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
    - 1.1.1.1
    - 8.8.8.8
  nameserver-policy:
    geosite:cn:
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
      - https://1.12.12.12/dns-query
      - https://223.5.5.5/dns-query
  proxy-server-nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
    - https://1.12.12.12/dns-query
    - https://223.5.5.5/dns-query
sniffer:
  enable: true
  parse-pure-ip: true
  override-destination: true
  sniffing:
    - tls
    - http
  force-domain:
    - "+.openai.com"
    - "+.chatgpt.com"
    - "+.anthropic.com"
    - "+.claude.ai"
    - "+.x.ai"
    - "+.grok.x.ai"
    - "+.perplexity.ai"
    - "+.pplx.ai"
    - "+.cohere.ai"
    - "+.cohere.com"
    - "+.mistral.ai"
    - "+.together.ai"
    - "+.together.xyz"
    - "+.openrouter.ai"
    - "+.huggingface.co"
    - "+.stability.ai"
    - "+.replicate.com"
  skip-domain:
    - "msftconnecttest.com"
    - "msftncsi.com"
proxies:
proxy-groups:
  # 基础选择器
  - name: Switch
    type: select
    proxies:
      - <all>
  - name: Intelligent
    type: select
    proxies:
      - Switch
      - <all>
      - <countries>
      - DIRECT
  - name: Google
    type: select
    proxies:
      - Switch
      - <all>
      - <countries>
      - DIRECT
  - name: Microsoft
    type: select
    proxies:
      - Switch
      - <all>
      - <countries>
      - DIRECT
  - name: Apple
    type: select
    proxies:
      - Switch
      - <all>
      - <countries>
      - DIRECT
  - name: Github
    type: select
    proxies:
      - Switch
      - <all>
      - <countries>
      - DIRECT
  - name: YouTube
    type: select
    proxies:
      - Switch
      - <all>
      - <countries>
      - DIRECT
  - name: Telegram
    type: select
    proxies:
      - Switch
      - <all>
      - <countries>
      - DIRECT
  - name: Twitter
    type: select
    proxies:
      - Switch
      - <all>
      - <countries>
      - DIRECT
  - name: AdGuard
    type: select
    proxies:
      - REJECT
      - DIRECT
  - name: Catch
    type: select
    proxies:
      - Switch
      - <all>
      - <countries>
      - DIRECT
rules:
  # 本地与私有网络直连
  - GEOSITE,private,DIRECT,no-resolve
  - GEOIP,private,DIRECT
  # 广告拦截
  - GEOSITE,category-ads-all,AdGuard
  # 信息收集
  - DOMAIN-REGEX,\\.log\\.,REJECT
  # AI
  - GEOSITE,openai,Intelligent
  - DOMAIN-SUFFIX,openai.com,Intelligent
  - DOMAIN-SUFFIX,chatgpt.com,Intelligent
  - DOMAIN-KEYWORD,openai,Intelligent
  - DOMAIN-SUFFIX,gemini.google.com,Intelligent
  - DOMAIN-SUFFIX,aistudio.google.com,Intelligent
  - DOMAIN-SUFFIX,ai.google.dev,Intelligent
  - DOMAIN-SUFFIX,generativelanguage.googleapis.com,Intelligent
  - DOMAIN-SUFFIX,makersuite.google.com,Intelligent
  - DOMAIN-SUFFIX,x.ai,Intelligent
  - DOMAIN-SUFFIX,grok.x.ai,Intelligent
  - DOMAIN-KEYWORD,grok,Intelligent
  - DOMAIN-SUFFIX,anthropic.com,Intelligent
  - DOMAIN-SUFFIX,api.anthropic.com,Intelligent
  - DOMAIN-SUFFIX,claude.ai,Intelligent
  - DOMAIN-KEYWORD,claude,Intelligent
  - DOMAIN-SUFFIX,perplexity.ai,Intelligent
  - DOMAIN-SUFFIX,api.perplexity.ai,Intelligent
  - DOMAIN-SUFFIX,pplx.ai,Intelligent
  - DOMAIN-SUFFIX,cohere.com,Intelligent
  - DOMAIN-SUFFIX,cohere.ai,Intelligent
  - DOMAIN-SUFFIX,api.cohere.ai,Intelligent
  - DOMAIN-SUFFIX,mistral.ai,Intelligent
  - DOMAIN-SUFFIX,api.mistral.ai,Intelligent
  - DOMAIN-SUFFIX,together.ai,Intelligent
  - DOMAIN-SUFFIX,together.xyz,Intelligent
  - DOMAIN-SUFFIX,api.together.xyz,Intelligent
  - DOMAIN-SUFFIX,openrouter.ai,Intelligent
  - DOMAIN-SUFFIX,api.openrouter.ai,Intelligent
  - DOMAIN-SUFFIX,huggingface.co,Intelligent
  - DOMAIN-SUFFIX,api-inference.huggingface.co,Intelligent
  - DOMAIN-SUFFIX,stability.ai,Intelligent
  - DOMAIN-SUFFIX,api.stability.ai,Intelligent
  - DOMAIN-SUFFIX,replicate.com,Intelligent
  - DOMAIN-SUFFIX,replicate.ai,Intelligent
  - DOMAIN-SUFFIX,api.replicate.com,Intelligent
  - DOMAIN-SUFFIX,copilot.microsoft.com,Intelligent
  # 始终直连
  - DOMAIN-KEYWORD,bilibili,DIRECT
  # 平台分流
  - GEOSITE,github,Github
  - GEOSITE,google,Google
  - GEOSITE,microsoft,Microsoft
  - GEOSITE,apple,Apple
  - GEOSITE,onedrive,Microsoft
  - GEOSITE,youtube,YouTube
  - GEOSITE,telegram,Telegram
  - GEOIP,telegram,Telegram
  - GEOSITE,twitter,Twitter
  # 中国大陆直连
  - GEOSITE,CN,DIRECT
  - GEOIP,CN,DIRECT
  # 兜底（漏网之鱼）
  - MATCH,Catch
