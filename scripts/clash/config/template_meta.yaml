mixed-port: 7890
allow-lan: true
external-controller: 0.0.0.0:9090
mode: Rule
log-level: info
ipv6: true
tcp-concurrent: true
unified-delay: true
dns:
  enable: true
  ipv6: true
  prefer-h3: false
  default-nameserver:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
    - 1.1.1.1
    - 8.8.8.8
  nameserver:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
    - 1.1.1.1
    - 8.8.8.8
  nameserver-policy:
    geosite:cn:
        - https://doh.pub/dns-query
        - https://dns.alidns.com/dns-query
        - https://1.12.12.12/dns-query
        - https://223.5.5.5/dns-query
  proxy-server-nameserver:
    - https://doh.pub/dns-query
    - https://dns.alidns.com/dns-query
    - https://1.12.12.12/dns-query
    - https://223.5.5.5/dns-query
sniffer:
  enable: true
  parse-pure-ip: true
  override-destination: true
  sniffing:
    - tls
    - http
  force-domain:
    - '+.openai.com'
    - '+.chatgpt.com'
    - '+.anthropic.com'
    - '+.claude.ai'
    - '+.x.ai'
    - '+.grok.x.ai'
    - '+.perplexity.ai'
    - '+.pplx.ai'
    - '+.cohere.ai'
    - '+.cohere.com'
    - '+.mistral.ai'
    - '+.together.ai'
    - '+.together.xyz'
    - '+.openrouter.ai'
    - '+.huggingface.co'
    - '+.stability.ai'
    - '+.replicate.com'
  skip-domain:
    - 'msftconnecttest.com'
    - 'msftncsi.com'
proxies:
proxy-groups:
  - name: 默认节点
    type: select
    proxies:
      - <all>
  - name: AI代理
    type: select
    proxies:
      - 默认节点
      - <all>
      - <countries>
      - DIRECT
  - name: 游戏平台
    type: select
    proxies:
      - 默认节点
      - <all>
      - <countries>
      - DIRECT
  - name: Telegram
    type: select
    proxies:
      - 默认节点
      - <all>
      - <countries>
      - DIRECT
  - name: Youtube
    type: select
    proxies:
      - 默认节点
      - <all>
      - <countries>
      - DIRECT
  - name: Microsoft
    type: select
    proxies:
      - 默认节点
      - <all>
      - <countries>
      - DIRECT
  - name: Apple
    type: select
    proxies:
      - 默认节点
      - <all>
      - <countries>
      - DIRECT
  - name: 广告拦截
    type: select
    proxies:
      - REJECT
      - DIRECT
  - name: 漏网之鱼
    type: select
    proxies:
      - 默认节点
      - <all>
      - <countries>
      - DIRECT
rules:
  - GEOSITE,private,DIRECT,no-resolve
  - GEOIP,private,DIRECT
  - GEOSITE,category-ads-all,广告拦截
  # AI代理（优先生效）
  - GEOSITE,openai,AI代理
  - DOMAIN-SUFFIX,openai.com,AI代理
  - DOMAIN-SUFFIX,chatgpt.com,AI代理
  - DOMAIN-KEYWORD,openai,AI代理
  - DOMAIN-SUFFIX,gemini.google.com,AI代理
  - DOMAIN-SUFFIX,aistudio.google.com,AI代理
  - DOMAIN-SUFFIX,ai.google.dev,AI代理
  - DOMAIN-SUFFIX,generativelanguage.googleapis.com,AI代理
  - DOMAIN-SUFFIX,makersuite.google.com,AI代理
  - DOMAIN-SUFFIX,x.ai,AI代理
  - DOMAIN-SUFFIX,grok.x.ai,AI代理
  - DOMAIN-KEYWORD,grok,AI代理
  - DOMAIN-SUFFIX,anthropic.com,AI代理
  - DOMAIN-SUFFIX,api.anthropic.com,AI代理
  - DOMAIN-SUFFIX,claude.ai,AI代理
  - DOMAIN-KEYWORD,claude,AI代理
  - DOMAIN-SUFFIX,perplexity.ai,AI代理
  - DOMAIN-SUFFIX,api.perplexity.ai,AI代理
  - DOMAIN-SUFFIX,pplx.ai,AI代理
  - DOMAIN-SUFFIX,cohere.com,AI代理
  - DOMAIN-SUFFIX,cohere.ai,AI代理
  - DOMAIN-SUFFIX,api.cohere.ai,AI代理
  - DOMAIN-SUFFIX,mistral.ai,AI代理
  - DOMAIN-SUFFIX,api.mistral.ai,AI代理
  - DOMAIN-SUFFIX,together.ai,AI代理
  - DOMAIN-SUFFIX,together.xyz,AI代理
  - DOMAIN-SUFFIX,api.together.xyz,AI代理
  - DOMAIN-SUFFIX,openrouter.ai,AI代理
  - DOMAIN-SUFFIX,api.openrouter.ai,AI代理
  - DOMAIN-SUFFIX,huggingface.co,AI代理
  - DOMAIN-SUFFIX,api-inference.huggingface.co,AI代理
  - DOMAIN-SUFFIX,stability.ai,AI代理
  - DOMAIN-SUFFIX,api.stability.ai,AI代理
  - DOMAIN-SUFFIX,replicate.com,AI代理
  - DOMAIN-SUFFIX,replicate.ai,AI代理
  - DOMAIN-SUFFIX,api.replicate.com,AI代理
  - DOMAIN-SUFFIX,copilot.microsoft.com,AI代理
  # 始终直连
  - GEOSITE,bilibili,DIRECT
  - GEOSITE,category-games@cn,DIRECT
  # 其它平台
  - GEOSITE,github,默认节点
  - GEOSITE,microsoft,Microsoft
  - GEOSITE,apple,Apple
  - GEOSITE,onedrive,Microsoft
  - GEOSITE,youtube,Youtube
  - GEOSITE,telegram,Telegram
  - GEOIP,telegram,Telegram
  - GEOSITE,category-games,游戏平台
  - GEOSITE,geolocation-!cn,默认节点
  - GEOSITE,CN,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,漏网之鱼
