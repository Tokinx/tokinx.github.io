# Loon自用配置

# =====================================
# General
# =====================================
[General]
# 按照 Clash 模板(template_meta.yaml)开启 IPv6 支持（Loon 用 auto 兼容 v4/v6）
ip-mode = auto
disable-stun = false
dns-reject-mode = LoopbackIP
domain-reject-mode = DNS
udp-fallback-mode = REJECT
sni-sniffing = true
disconnect-on-policy-change = false
switch-node-after-failure-times = 3
# > 跳过某个域名或者IP段
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,e.crashlynatics.com
bypass-tun = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32
# > DNS 服务器（参考 template_meta.yaml 的 DoH 首选项）
# Loon 不支持按地理域定向解析策略(nameserver-policy)，仅设置通用 DoH + 纯 IP 备选
dns-server = system,223.5.5.5,119.29.29.29,https://1.1.1.1/dns-query,https://8.8.8.8/dns-query,1.1.1.1,8.8.8.8
interface-mode = auto
# Wi-Fi 访问
# > 允许 Wi-Fi 网络下其它设备访问
#allow-udp-proxy = false
# allow-wifi-access = false
# wifi-access-http-port = 7222
# wifi-access-socks5-port = 7221
# > 代理测速 URL
proxy-test-url = http://www.google.com/generate_204
internet-test-url = http://connectivitycheck.platform.hicloud.com/generate_204
# > 测速超时 (s)
test-timeout = 5
# > 解决一些ip请求无法匹配域名类规则的问题。real-ip指定的域名将不返回fake ip响应，直接将dns请求发往目标dns服务器
real-ip = msftconnecttest.com,msftncsi.com,*.msftconnecttest.com,*.msftncsi.com,*.srv.nintendo.net,*.stun.playstation.net,xbox.*.microsoft.com,*.xboxlive.com,*.battlenet.com.cn,*.battlenet.com,*.blzstatic.cn,*.battle.net
# 解析器
resource-parser = https://github.com/sub-store-org/Sub-Store/releases/latest/download/sub-store-parser.loon.min.js
# geoip
geoip-url = https://github.com/Masaiki/GeoIP2-CN/raw/release/Country.mmdb
# ssid-trigger参数，用于指定SSID下流量模式切换，（default表示默认，cellular表示蜂窝，目前支持三种值：rule，direct，proxy） 
# ssid-trigger="default":rule,"cellular":rule,"ASUS":direct,"TPLINK":proxy 
ipasn-url = https://raw.githubusercontent.com/P3TERX/GeoLite.mmdb/download/GeoLite2-ASN.mmdb


# =====================================
# Host
# =====================================
[Host]
# 改善App Store下载速度
# iosapps.itunes.apple.com = iosapps.itunes.apple.com.download.ks-cdn.com


# =====================================
# Proxy 本地的代理节点
# =====================================
[Proxy]


# =====================================
# Remote Proxy 订阅链接
# =====================================
[Remote Proxy]


# =====================================
# Proxy Group
# =====================================
[Proxy Group]
# 提供一个“所有节点”聚合以手动选择；其成员由极简筛选 All 提供
Switch = select,All
# 常用分流策略（全部可手动选择节点，不再依赖地域筛选）
Intelligent = select,Switch,All,DIRECT,img-url = https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/ChatGPT.png
Google = select,Switch,All,DIRECT,img-url = https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/Google.png
Microsoft = select,Switch,All,DIRECT,img-url = https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/Microsoft.png
Apple = select,Switch,All,DIRECT,img-url = https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/Apple_01.png
Github = select,Switch,All,DIRECT,img-url = https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/github_01.png
YouTube = select,Switch,All,DIRECT,img-url = https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/YouTube_01.png
Telegram = select,Switch,All,DIRECT,img-url = https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/Telegram_01.png
Twitter = select,Switch,All,DIRECT,img-url = https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/Twitter_01.png
AdGuard = select,REJECT,DIRECT,img-url = https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/AdGuard.png
Catch = select,Switch,All,DIRECT,img-url = https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/warp.png


# =====================================
# Remote Filter
# (?i)：表示后面整个括号内的表达式不区分大小写
# =====================================
[Remote Filter]
# 极简：仅保留全量匹配，供“所有节点”组手动选择使用
All = NameRegex, FilterKey = ".*"


# =====================================
# Rule
# Options:no-resolve(only for cidr)
# =====================================
[Rule]
# 信息收集
URL-REGEX,\.log\.,REJECT

# ====== 按 template_meta.yaml 同步的核心分流 ======
# 广告拦截（置前优先生效，规则来源见 [Remote Rule]）

# AI 相关（优先处理）
DOMAIN-SUFFIX,aistudio.google.com,Intelligent
DOMAIN-SUFFIX,ai.google.dev,Intelligent
DOMAIN-SUFFIX,generativelanguage.googleapis.com,Intelligent
DOMAIN-SUFFIX,makersuite.google.com,Intelligent
DOMAIN-SUFFIX,x.ai,Intelligent
DOMAIN-SUFFIX,grok.x.ai,Intelligent
DOMAIN-KEYWORD,grok,Intelligent
DOMAIN-SUFFIX,perplexity.ai,Intelligent
DOMAIN-SUFFIX,api.perplexity.ai,Intelligent
DOMAIN-SUFFIX,pplx.ai,Intelligent

# 始终直连
DOMAIN-KEYWORD,bilibili,DIRECT

# 中国大陆直连
GEOIP,CN,DIRECT

# 兜底（漏网之鱼）
FINAL,Catch


# =====================================
# Remote Rule
# =====================================
[Remote Rule]
# 广告拦截
https://github.com/fmz200/wool_scripts/raw/main/Loon/rule/rejectAd.list, policy=AdGuard, tag=AdGuard@fmz200, enabled=true
# AI 相关
https://github.com/fmz200/wool_scripts/raw/main/Loon/rule/AI.list, policy=Intelligent, tag=Intelligent@fmz200, enabled=true
# 社交软件
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Loon/Telegram/Telegram.list, policy=Telegram, tag=Telegram@bm7, enabled=true
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Loon/Twitter/Twitter.list, policy=Twitter, tag=Twitter@bm7, enabled=true
# 流媒体
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Loon/YouTube/YouTube.list, policy=YouTube, tag=YouTube@bm7, enabled=true
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Loon/YouTubeMusic/YouTubeMusic.list, policy=YouTube, tag=YouTubeMusic@bm7, enabled=true
# 主要平台
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Loon/Google/Google.list, policy=Google, tag=Google@bm7, enabled=true
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Loon/Microsoft/Microsoft.list, policy=Microsoft, tag=Microsoft@bm7, enabled=true
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Loon/OneDrive/OneDrive.list, policy=Microsoft, tag=OneDrive@bm7, enabled=true
https://github.com/blackmatrix7/ios_rule_script/raw/master/rule/Loon/GitHub/GitHub.list, policy=Github, tag=Github@bm7, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/Loon/rule/AppleAll.list, policy=Apple, tag=Apple@fmz200, enabled=true
# 局域网 & 中国大陆直连
https://github.com/fmz200/wool_scripts/raw/main/Loon/rule/LAN.list, policy=DIRECT, tag=LAN@fmz200, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/Loon/rule/GeoIP_CN.list, policy=DIRECT, tag=GeoIP_CN@fmz200, enabled=true


# =====================================
# Rewrite
# =====================================
[Rewrite]


# =====================================
# Script
# =====================================
[Script]


# =====================================
# Remote Script
# =====================================
[Remote Script]
https://github.com/fmz200/wool_scripts/raw/main/Loon/script/tasks.scripts, tag=定时任务合集@fmz200, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/Loon/script/tools.scripts, tag=脚本工具合集@fmz200, enabled=true


# =====================================
# 插件
# =====================================
[Plugin]
https://github.com/fmz200/wool_scripts/raw/main/Loon/plugin/cookies.plugin, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/Loon/plugin/weibo.plugin, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/Loon/plugin/blockAds.plugin, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/Loon/plugin/WeChatMiniAds.plugin, enabled=true
https://raw.githubusercontent.com/001ProMax/Surge/main/Loon/Spotify.plugin, img-url=https://raw.githubusercontent.com/fmz200/wool_scripts/main/icons/apps/spotify.png, enabled=true
https://raw.githubusercontent.com/Tartarus2014/Loon-Script/refs/heads/master/Plugin/skip-proxy.lpx, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Alpha/Imm.png, enabled=true
https://raw.githubusercontent.com/VirgilClyne/GetSomeFries/main/plugin/HTTPDNS.Block.plugin, enabled=true
https://github.com/fmz200/wool_scripts/raw/main/Loon/plugin/Auto_Join_TF.plugin, policy=Switch, enabled=false
https://raw.githubusercontent.com/chavyleung/scripts/master/box/rewrite/boxjs.rewrite.loon.plugin, policy=Switch, enabled=true
https://raw.githubusercontent.com/sub-store-org/Sub-Store/master/config/Loon.plugin, policy=Switch, enabled=true
https://raw.githubusercontent.com/Script-Hub-Org/Script-Hub/main/modules/script-hub.loon.plugin, policy=Switch, enabled=true


# =====================================
# Mitm
# =====================================
[Mitm]
hostname = -www.google.com
ca-p12 = 
ca-passphrase = 
skip-server-cert-verify = false
